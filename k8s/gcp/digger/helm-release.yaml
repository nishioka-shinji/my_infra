apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: digger
  namespace: digger
spec:
  interval: 30m
  chart:
    spec:
      chart: digger-backend
      version: "0.1.12"
      sourceRef:
        kind: HelmRepository
        name: digger
  postRenderers:
    - kustomize:
        patches:
          - patch: |-
              - op: add
                path: /spec/template/spec/nodeSelector
                value:
                  cloud.google.com/gke-spot: "true"
            target:
              kind: StatefulSet
              name: digger-digger-backend-postgres
  values:
    digger:
      nodeSelector:
        cloud.google.com/gke-spot: "true"
      resources:
        requests:
          cpu: 250m
          memory: 500Mi
        limits:
          cpu: 250m
          memory: 500Mi
      ingress:
        enabled: false
      secret:
        httpBasicAuthUsername: "admin"
        httpBasicAuthPassword: "password"
        bearerAuthToken: "token"
        hostname: "https://digger.nishiokatest.xyz"
        githubOrg: "AKASHI-rb"
        githubAppID: "2034313"
        githubAppClientID: "Iv23liTzgyvVNzylkXef"
        githubAppClientSecret: "4942a18c27f6dd17af60fea20ef2e77da111967c"
        githubAppKeyFile: "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBdytQNGJIVFpoSGhmYkhRMkozT3I0RXhNWWVUTTR3a0NGRjBCdXQ0bjhrSkZVOUtWClU3UC8zK2pTVFlramtpZGVqQ2JWdDdvMFdSck1nQVBVMHY2YjBGZVF0YTFkK0MwR0Ydk5RN1B6bko0d2V4cU8KTE12YUJLZUVSV0pVc055MGNtZVdBSGpCcmFodmttN1J0endJcTJCRTBGNHoyZWZsTERQUkoxQW9RaGRMQ1Y0Twp0U3FieHRybVdZMmI1VGYrMTFCYmdMRTNEcUN1RGRpRDk5Y2c5SjhLeFNtSTVWVWVzTEYrQTU4N210NkM5NU11CjdNR1FibE9JTkRpRGd4Z2VySHN4S1VnQUMzRnpGTDdBbFZRazNONXN5NGJlaWd4M0JkWGpka0JKWlY4NTk3V0MKcEpMQzdWOXFoSkFIVU1XNEhHZVVZYVp5Rm0xdUF5MVl1dllJTFFJREFRQUJBb0lCQUFzMitmbjdscGhtNjgraAp0NWY2bjFSd0NjOXc4ZW50a2hqb1dqa0Fqdmpub21CeUplcHMyN0ZOK3Z4RlphdndaUkZSQjl0RTVjcFVKbkVOCnh4bHRTaTViVlFXUnIxZU4vRk5Oc0NxNEdySlV2Q0hRRzJPbEtBNHNLUDV2NnJsVmFWOURYdXNYL3I2YWJnak0KSDJXR0lsanRZZ01yNFh3UU1xYWRNTlEzV3BhdDlReFdMQ2E5eUx0S3RMMERMSVJaODZYZ2taMGdsTjhoZVdpbQorU1FWN0tQTkVpTVJaTWFlN1ZTZWhEYjBrRVpQa2NwQVJZUjFTUnZscnMvMVRscENZUVg0dWNCc1U2ajVRL1ZmCnJUWHlnRDc4ZmtJblhxRGdRMG1BMXNWcDVETElNUHJ5a00yeDhXTXJSU1pvVlF5UjdPU1pGQ3hkUUNDbEhFMUoKMThoSE0yRUNnWUVBNlIxcjRmL0Nra282a3Ewb0RuQkl2ZldnN0h1dWMvZFF1aWFJKzZ5RmdTRUZsM0dvb0xUZQo0MVlOclcyb0trS0R2d3kzb05BM0lURmNiSE9md2wySDYxNUZpam14UWpaSUNzMG5yNkR0K0FMOVRlMVZBVEkyCng5UUJsK3ZhQjNFMXBwL2NZT29lWndCRDdIUmUzSzUxRnVRTDUyaDRnbEZxY3ZuWVMwVzFveHNDZ1lFQTF4OEoKRVJUTDlrOFdPZ205MytsTnJ5ZEQ3LzdiVXphSnhuUWNwWStjNXFzWElvZzFsMmRXMldnR0FtNFF4bDVlbEU0UApiUW5LZHN5YXJSdDRxa0JDZDRNSmRTK1ZYd3BSZHBCOEpNUmlla0piazhVL2RSSUs1SkVSOU43MXRFTUNrR1pZCkRwc25kVHRrRVZPQW42Zlg1aGpXY0FOMEN6U05TWGxiUWJiU2JsY0NnWUFrclJ0WElFMDFoUFk0TTRRVTJYZW8KWTJmaExRaGllR3U4RGVvSlpyaE9lNnFNakRaU3FvSlMxQ3dzdUE3NEx5VFpQeC80N2lsdVVIelJGMVB3V1pUVAo1QzRldERyK1J0b0kwUVJJYnBKaUxkNDZqM2VMUzZJd3lGdEQwcmluNlJqZTBWSHo4WUc5Qk42cTZoZ3Vza2Y3CnhQOVdkaXBYbm9XWDkxVWZhcVZNTndLQmdId2lvcDdDdTNmazUxU1Nib2taSGdUbXlhTmlFN29QREs0Q0xzMnkKODcyQUdSZUtOaktxSlVuTFp6eGJ1ejVkRW9MT0VNVEJFNTQrTHp1WlVLWWQ4cno0VnFyU3pJVk5kUGpRSTNNcwpDQSs0M3hPRWpUdkhMNVg1eUx6Zk5EWFRQVldLV1dJRVVsNnA2UEsrbHNpS21HRmxEOGtQbFJVcVBDV2I2L2NkCndveDlBb0dCQU9oeGR1cDljdWUveGdQanpyZEpoTEZ6Qk1lMGdCZnVta3FRNkZNenlCbGcwQjBJK2pNZjVLZHMKWEpjaHdQa0FobUw4aFJtVHpUdjFRZ3dqdGk1WkpOaDJyaW0wQXRPb1l6V0NXSXFZN0JTYkRzdjRaYjI4ejZwOQpvam1BclIzNjJUMWU0bEJDK2tvZCtITUw2S3JFeGxTOW1PRmhSOWRkNTVrQ1h0N1lEY2NzCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg=="
        githubWebhookSecret: "ca2d8fd8fa7d3d8640449a30946f1b8abe849fdd"
    postgres:
      enabled: true
      secret:
        useExistingSecret: false
        password: "password"
      resources:
        requests:
          cpu: 250m
          memory: 500Mi
        limits:
          cpu: 250m
          memory: 500Mi
